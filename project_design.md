# 项目目标

设计一个SLAM 系统，包含前端视觉里程计和后端优化，能够实时运行，能够重建局部的地图信息；



# 代码规约

### 一 、 版面规约

1. **一个函数的长度不超过一个页面长度即100行；尽可能的让函数短小精悍；**

2. 各个函数体之间两行留白；
3. 一行代码只有一个语句； 除了if 或者 内联函数中仅仅包含一条简单语句的情况。
4. **长括号两端要使用括号前的名称进行表示，防止混淆；**
5. 每行代码不超过90列；除了头文件、URL这些；
6. 使用TAB，相当于8空格缩进;
7. 类和结构体、枚举等类型定义的时候，左花括号在类型定义的那一行，函数的左花括号在另一行的开头；
9. **if 和 （ 之间有一个空格， ） 和 { 之间也存在一个空格；**
10. switch 语句中 ， 各个case: 内的情况， 要使用{  } 包裹起来；  case 1:// switch case 的冒号前无空格。
11.  指针/地址操作符 (*, &) 之后不能有空格， *  和 & 都靠近类型，而不是变量；const string& str;  char* c;
12. if 条件中如果有多个条件，则 && 或者 || 等需要放到一行的最后，一行不超过规定列，超过则多个条件分多行；
13. 即使预处理指令位于缩进代码块中, 指令也应从列首开始.
14. 关键词 public:, protected:, private: 要缩进 4 个空格.
15. 构造函数的初始化列表 按一个TAB缩进；
16. 命名空间不进行缩进；
17. **大括号前后都要空格；两边都要加上；int x[] = { 0 };**
18. 二元操作前后恒有空格，每行最后无多余空格；
19. <> 前后均无空格；
20. {} 要么写在同一行（内容简短的情况），要么两个都独占一行；（冗长的情况）

### 二 、设计规约

1. **先进行文档设计，再进行代码的书写；**
2. 尽可能地避免使用前置声明。使用 #include 包含需要的头文件即可。除了A包含B的指针/引用，B包含A的指针/引用这种情况；

### 三 、 变量规约

1. 优先使用智能指针，因为可以在合适的地方自主释放；
2. 所有变量定义时都要进行初始化；
3. 变量应该在距离最近使用的地方进行初始化，且初始化的时候尽量使用花括号；且应该一次初始化，而不是定义之后再进行赋值；
4. 循环内部定义的变量，应该改为在循环之外定义，可以避免多次调用构造函数和析构函数；
5. 只有数据成员时，使用 struct ,其他一律使用class；
6. 使用 C++ 的类型转换, 如 static_cast<>(). 不要使用 int y = (int)x 或 int y = int(x) 等转换方式;
7. 要明确表示int 类型的长度，不确定的可以使用更大的类型表示，包含头文件<stdint.h> 即可，　如　 int64_t;
8. 不要为了指出数值永远不为负值而使用unsigned 类型，而是应该使用断言来进行保护；
9. 减少宏的使用，使用内联函数、枚举、常量进行代替，　局部 使用了　＃define 之后，再使用 #undef　进行消除；
10. **整数用 0, 实数用 0.0, 指针用 nullptr 或 NULL, 字符 (串) 用 '\0'.**
11. 尽可能用 sizeof(varname) 代替 sizeof(type),一般目的是为了测量varname 的长度，所以直接测变量名更加准确，可以避免不必要的错误，除非必须要使用sizeof(type),否则使用 sizeof(varname);
12. **auto 只能用在局部变量里用。**别用在文件作用域变量，命名空间作用域变量和类数据成员里。永远别列表初始化 auto 变量。
13. **变量命名规则： 变量类型 + 定语 +名词；　中间使用下划线“_"进行分割；**
14. 对于容器，前面使用v_ 表示vector, m_ 表示map；vp_ 表示元素为指针的vector；vsp_ 表示 vector<shared_ptr<TYPE>>等等，依次类推，vwp_ 表示 vector<weak_ptr<TYPE>> 等等；

### 四 、 函数规约

1. **所有可能出错的地方，都要进行LOG 验证，函数返回值都要检查是否符合预期；或者使用ASSERT 或者 CHECK_EQ();**
2. **一个函数只去完成一个功能；**
3. **不要使用裸的全局函数，可以使用静态成员函数或者限定在命名空间内的非成员函数。**
4. **对于复杂类型，尽量使用函数，而不是运算符的重载；+ 、-**
5. **所有的引用传递必须要加const ,  作为纯输入参数时使用const 引用，作为输入输出参数的时候，使用不带const  的指针；**
6. **非必要的情况下，不要使用缺省参数；**
7. 只有在记录日志的时候用，使用流；
8. **我们强烈建议你在任何可能的情况下都要使用 const. 此外有时改用 C++11 推出的 constexpr 更好。**
9. 除了使用explict　声明的构造函数，其他都可以使用｛｝初始化列表的形式进行初始化；
10. 不要使用复杂的模板编程；
11. 非空列表初始化就会优先调用 std::initializer_list, 不过空列表初始化除外，后者原则上会调用默认构造函数，优先使用 初始化列表{}，可以防止隐式转换；

### 五、文件规约

1. 一个文件一个类，分别有存放在src 和 include里；
2. 所有头文件都应该使用 #define 来防止头文件被多重包含, 宏命名格式当是::项目名称_路径名称 _文件名称\_H\_
3. 用到哪些头文件，就要在本文件中去包含； 比如你现在需要A.h， B.h 里已经包含了A.h， 现在你包含了B.h， 但是还需要手动去包含A.h;  (显式依赖，防止B 改变以后，影响到当前文件对A.h的包含；)
4. **C++ 可以使用错误代码和 断言来替代异常操作；why ?** 

### 六 、顺序规约

1. 类中成员函数和成员变量的声明顺序： public:, protected:, private， 成员函数在成员变量之前； **具体顺序为 typedefs 和枚举 -> 常量 -> 构造函数 -> 析构函数 -> 成员函数 -> 数据成员；** 
2. 头文件包含顺序：**和本源文件对应的头文件，C库文件，C++库文件，其他库文件，本项目中其他.h文件**，且不允许使用 ./ 或者 ../ 这样开头的相对路径， 应该使用相对于工作空间的文件路径；各个类型头文件之间通过行注释进行区分；

### 七 、 命名规约

1. **函数名、变量名、文件名　命名时，除了行业共识的缩写之外，都要使用全拼，杜绝使用少数字母、局部缩写、或者只有本团队才能看懂的缩写；**
2. 文件命名：C++ 文件要以 .cc 结尾, 头文件以 .h 结尾.
3. 类型命名：类型命名的每个首单词都要进行大写，不包含下划线；如　：　MyExcitingClass
4. 变 量 名 一 律 小 写, 单 词 之 间 用 下 划 线 连 接.类 的 **成 员 变 量** 以 下 划 线 结 尾, 但 结 构 体 的 **成员变量**就 不 用， 如::a_local_variable, a_struct_data_member, a_class_data_member_.　全局变量使用ｇ\_ 作为开头；**定语在前，主语在后**；
5. **在全局或类里的常量名称前加 k: kDaysInAWeek. 且除去开头的 k 之外每个单词开头字母均大写。 const int kDaysInAWeek = 7;**
6. **成员函数命名应该以 动词+名词+定语_ 小写字母**，用下划线分割的形式命名，**普通函数应该以每个单词首字母大写开头，** **如果一个函数中存在 crash的操作，函数名最后加 OrDie;**
7. 名字空间用小写字母命名, 并基于项目名称和目录结构: google_awesome_project.（暂时不用）
8. 枚举命名全部使用大写；

### 八 、 注释规约

1. 单行 使用 //, 多行使用/*    */ 进行注释；应该在行上进行注释，尽量不要在行尾进行注释；

2. 每个文件都应该加入版权公告，然后是文件内容描述；（暂时不做）

3. **每个类都要加前置的注释,如果有多线程访问，请务必说明；**

4. 每个函数要求在声明时加入描述性注释： 函数名，函数功能 ，输入参数，输出参数，**返回值，注意事项；**

5. **每个非简单含义的变量，都要使用注释说明用途；**

6. **对代码中实现巧妙的点和难懂的点，要加以注释说明**，永远不要 用自然语言翻译代码作为注释，不要说明流程，而是说明目的；

7. 对那些临时的, 短期的解决方案, 或已经够好但仍不完美的代码使用 TODO 注释,TODO 注释要使用全大写的字符串 TODO, 在随后的圆括号里写上你的大名, 邮件地址, 或其它身份标识. 冒号是可选的.TODO(kl@gmail.com): Use a "*" here for concatenation operator.如果加 TODO 是为了在 “将来某一天做某事”, 可以附上一个非常明确的时间 “Fix by November 2005”), 或者一个明确的事项 (“Remove this code when all clients can handle XML responses.”).

8. **通过弃用注释（DEPRECATED comments）以标记某接口点（interface points）已弃用。**

   

